"use strict";(()=>{var e={};e.id=438,e.ids=[438],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},2079:e=>{e.exports=import("openai")},6249:(e,r)=>{Object.defineProperty(r,"l",{enumerable:!0,get:function(){return function e(r,n){return n in r?r[n]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,n)):"function"==typeof r&&"default"===n?r:void 0}}})},3947:(e,r,n)=>{n.a(e,async(e,t)=>{try{n.r(r),n.d(r,{config:()=>u,default:()=>c,routeModule:()=>d});var a=n(1802),o=n(7153),i=n(6249),s=n(1746),l=e([s]);s=(l.then?(await l)():l)[0];let c=(0,i.l)(s,"default"),u=(0,i.l)(s,"config"),d=new a.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/aura-reading",pathname:"/api/aura-reading",bundlePath:"",filename:""},userland:s});t()}catch(e){t(e)}})},1746:(e,r,n)=>{n.a(e,async(e,t)=>{try{n.r(r),n.d(r,{config:()=>m,default:()=>i});var a=n(2079),o=e([a]);a=(o.then?(await o)():o)[0];let s=e=>{let r=0;for(let n=0;n<e.length;n++)r=31*r+e.charCodeAt(n)>>>0;return r},l=["#FBBF24","#22C55E","#38BDF8","#A855F7","#EC4899","#F97316","#2DD4BF"],c={"#FBBF24":["self-worth","confidence","solar plexus"],"#22C55E":["heart healing","growth","grounding"],"#38BDF8":["clarity","communication","calm mind"],"#A855F7":["mysticism","intuition","psychic senses"],"#EC4899":["love","emotional alchemy","relationship repair"],"#F97316":["creative fire","expression","play"],"#2DD4BF":["balance","flow","nervous system soothing"]},u=["111","222","333","444","555","666","777","888","999"],d=process.env.OPENAI_API_KEY||"";async function i(e,r){if("POST"!==e.method)return r.status(405).json({error:"Method not allowed"});let{imageData:n}=e.body;if(!n)return r.status(400).json({error:"Missing image data"});let t=function(e){let r=s(e||"fallback"),n=r%l.length,t=(n+3)%l.length,a=l[n],o=l[t],i=c[a]??["alignment"],d=c[o]??["integration"],m=Array.from(new Set([...i,...d])),g=u[r%u.length],p=u[(r>>3)%u.length],y=Array.from(new Set([g,p])).slice(0,2);return{primaryColor:a,secondaryColor:o,intensity:.35+r%1e3/1e3*.6,reading:"Your aura shows layered color fields today. A primary band close to the body and a softer outer halo reveal where your energy is focusing and how it is integrating.",angelNumbers:y,keywords:m}}(n);if(!d)return console.warn("[Aura API] OPENAI_API_KEY missing. Returning local aura only."),r.status(200).json(t);try{let e=new a.default({apiKey:d}),r=`
You are a mystical yet grounded aura reader.
You receive a summary of a person's aura colors, intensity, and themes.
Write a short, warm, channeled-style interpretation in 2–3 paragraphs.
Speak in second person ("you"), be encouraging, and avoid generic clich\xe9s.
    `.trim(),n=`
Aura summary:
- Primary color: ${t.primaryColor}
- Secondary color: ${t.secondaryColor}
- Intensity (0–1): ${t.intensity.toFixed(2)}
- Keywords: ${t.keywords.join(", ")}
- Angel numbers: ${t.angelNumbers.join(", ")}

Write the interpretation now.
    `.trim(),o=await e.chat.completions.create({model:"gpt-4o-mini",temperature:.7,messages:[{role:"system",content:r},{role:"user",content:n}]}),i=o.choices[0]?.message?.content?.trim();i?t={...t,reading:i}:console.warn("[Aura API] OpenAI returned empty content, keeping local reading.")}catch(e){console.error("[Aura API] Error calling OpenAI, keeping local reading:",e)}return r.status(200).json(t)}let m={api:{bodyParser:{sizeLimit:"10mb"}}};t()}catch(e){t(e)}})},7153:(e,r)=>{var n;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},1802:(e,r,n)=>{e.exports=n(145)}};var r=require("../../webpack-api-runtime.js");r.C(e);var n=r(r.s=3947);module.exports=n})();